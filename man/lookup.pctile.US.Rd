% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lookup.pctile.US.R
\name{lookup.pctile.US}
\alias{lookup.pctile.US}
\title{old code to create a look up table to find percentile that a raw score is at within USA}
\usage{
lookup.pctile.US(
  data,
  thisregion = "USA",
  geolevel = "usa",
  fields2process = NULL,
  lookupfields = NULL,
  fields_outputnames = NULL,
  fields_outputnames_means = NULL,
  factors = NULL
)
}
\arguments{
\item{data}{indicators data.table?}

\item{thisregion}{default is USA}

\item{geolevel}{default is usa, can be used to get state or region percentiles}

\item{fields2process}{names of columns to use in data}

\item{lookupfields}{corresponding version of those colnames as used in the lookup table}

\item{fields_outputnames}{colnames for percentiles in outputs}

\item{fields_outputnames_means}{colnames for means in outputs}

\item{factors}{vector of scaling values to convert to correct units like 1, 0.01, etc. (see source code)}
}
\value{
data.table of 100 percentiles and mean (in rows) for each indicator (in columns)
}
\description{
needs to have in global envt statestats, regionstats, or usastats depending on geolevel -
  Can recode to make those data() in this package.
}
\details{
CURRENTLY HARD CODED TO USE THESE SPECIFIC FIELDS - NEEDS TO BE MADE GENERIC.

  This should be about the same as ejanalysis::lookup.pctile()
  using lookup tables from something like ejscreen::ejscreen.lookuptables()
  See user ejanalysis, ejscreen and ejanalysis packages on GitHub
  e.g.,  state.pctiles[,i] <- lookup.pctile(myvector = bg[,names.e[i]], varname.in.lookup.table = names.e[i],
         lookup = lookupStates, zone = bg$ST) 
  
> library(ejanalysis)
> library(ejscreen)
> library(analyze.stuff)
> x <- write.wtd.pctiles(blockgroupstats21[ , c(names.d, names.d.subgroups, names.e, names.ej)], wts = blockgroupstats21$pop,  filename = 'lookupUSA21.csv')
Error in approx(w$ecdf, w$x, xout = probs, rule = 2) : 
  need at least two non-NA values to interpolate
In addition: Warning message:
  In xy.coords(x, y, setLab = FALSE) : NAs introduced by coercion
Called from: approx(w$ecdf, w$x, xout = probs, rule = 2)
}
