% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/doaggregate2.R
\name{doaggregate2}
\alias{doaggregate2}
\title{Summarize indicators in each buffer (given the blocks in each buffer and indicators for each block)}
\usage{
doaggregate2(sites2blocks, ...)
}
\arguments{
\item{sites2blocks}{data.table of distances in miles between all sites (facilities) and 
nearby Census block internal points, with columns siteid, blockid, distance,
created by getrelevant... function.}

\item{...}{more to pass}
}
\description{
This updated 2022 code takes a set of facilities and the set of blocks that are near each,
  (as identified previously, in other code that has identified which blocks are nearby)
  and combines those with indicator scores for block groups.

  It aggregates the scores as population weighted means, (check that - all of them?)
  creating a summary of each indicator, in each buffer (i.e., near each facility).
}
\details{
\preformatted{

  As currently written, requires the following already be in the global environment,

   blockdata  data.table (was 335 MB as .rdata) with these columns: blockfips, bgfips, STUSAB, blockpop2010, bgpop2010, blockwt, 
   # INTPTLAT, INTPTLON, BLOCK_LAT_RAD, BLOCK_LONG_RAD  BLOCK_X   BLOCK_Y  BLOCK_Z ID GRID_X GRID_Y GRID_Z 
   # old names: blockid, BLOCKGROUPFIPS, STUSAB, STATE, COUNTY, TRACT, BLKGRP, BLOCK, POP100, HU100, Census2010Totalpop
   
   blockgroupstats - A data.table (such as EJSCREEN demographic and environmental data by blockgroup?)
   statesshp   (a shapefile of state boundries to determine what state a point is in)
   stateregions  data.table lookup of EPA REGION given the ST (state code like AK)

   only these are passed to the function rather than being already in the global envt:
     facilityblocks - passed to the function
     facilities

   Check which table has which column names, including columns with
      distance, statename?,  REGION etc.

   Check if it includes Puerto Rico ( that was dropped?? - but it is in blocks, and in blockgroupstats for most fields though not race/ethnic subgroups)
 }
}
